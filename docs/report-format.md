# レポート形式ガイド

このガイドでは、AWS リソース・コスト レポートツールで生成されるレポートの形式と内容について詳しく説明します。

## レポート形式

レポートはマークダウン（`.md`）形式で生成されます。この形式はGitHubで直接閲覧でき、表や見出しなどの基本的な書式設定をサポートしています。また、CSV形式への変換も容易です。

## レポートのファイル構造

レポートファイルは以下の命名規則で生成されます：

```
aws_resource_cost_report_YYYYMMDD_HHMMSS.md
```

ここで：
- `YYYYMMDD` - レポート生成日（年月日）
- `HHMMSS` - レポート生成時刻（時分秒）

例：`aws_resource_cost_report_20250322_123456.md`

すべてのレポートは `reports/` ディレクトリに保存され、`reports/index.md` ファイルから最新のレポートにアクセスできます。

## レポートの構成

各レポートは以下のセクションで構成されています：

### 1. ヘッダー

レポートの先頭には、タイトル、期間、作成日時が含まれます：

```markdown
# AWS リソース・コスト レポート

**期間**: 2025-02-20 から 2025-03-20
**作成日時**: 2025-03-22 09:15:30
```

### 2. 概要

概要セクションには、分析期間の総コスト、前期間との比較、最も費用がかかっているサービスに関する情報が含まれます：

```markdown
## 概要

### 総コスト

**合計**: 5432.10 USD

**前期間 (2025-01-20 ~ 2025-02-19) 比較**: 🔴 256.78 USD (↑ 4.96%)

**最大コストサービス**: Amazon Elastic Compute Cloud - Compute (2345.67 USD)
```

この例では：
- 総コストは 5,432.10 USD
- 前期間と比較して 256.78 USD (4.96%) 増加（🔴は増加を示す）
- 最もコストがかかっているサービスは EC2 で 2,345.67 USD

増減表示は以下の通りです：
- 🔴 増加
- 🟢 減少
- ⚪ 変化なし

### 3. サービス別コスト

サービス別のコスト内訳が表形式で表示されます：

```markdown
## サービス別コスト

| サービス | コスト | 全体比 |
| --- | ---: | ---: |
| Amazon Elastic Compute Cloud - Compute | 2345.67 USD | 43.18% |
| Amazon Relational Database Service | 986.43 USD | 18.16% |
| Amazon Simple Storage Service | 654.32 USD | 12.05% |
| ... | ... | ... |
```

この表には各AWSサービスのコストと、全体に対する割合（%）が含まれます。サービスはコストの高い順にソートされます。

### 4. リージョン別コスト

リージョン別のコスト内訳も表形式で表示されます：

```markdown
## リージョン別コスト

| リージョン | コスト | 全体比 |
| --- | ---: | ---: |
| ap-northeast-1 | 3456.78 USD | 63.64% |
| us-east-1 | 1245.67 USD | 22.93% |
| ... | ... | ... |
```

### 5. EC2インスタンス詳細

EC2インスタンスの詳細情報が表形式で表示されます：

```markdown
## EC2インスタンス詳細

| インスタンスID | 名前 | タイプ | 状態 | リージョン | 起動日時 | 推定月間コスト |
| --- | --- | --- | --- | --- | --- | ---: |
| i-0a1b2c3d4e5f67890 | app-server-1 | m5.xlarge | running | ap-northeast-1 | 2024-10-15 | 145.67 USD |
| ... | ... | ... | ... | ... | ... | ... |
```

この表には各EC2インスタンスの基本情報とコスト見積もりが含まれます。状態が「stopped」のインスタンスは、後のコスト最適化推奨事項セクションで特に注目されます。

### 6. RDSインスタンス詳細

RDSインスタンスの詳細情報も表形式で表示されます：

```markdown
## RDSインスタンス詳細

| インスタンスID | エンジン | タイプ | 状態 | リージョン | 作成日時 | ストレージ(GB) | マルチAZ | 推定月間コスト |
| --- | --- | --- | --- | --- | --- | ---: | --- | ---: |
| db-main-01 | MySQL 8.0.28 | db.m5.xlarge | available | ap-northeast-1 | 2024-10-20 | 100 | はい | 345.67 USD |
| ... | ... | ... | ... | ... | ... | ... | ... | ... |
```

この表にはRDSインスタンスの詳細情報が含まれます。「マルチAZ」列は、インスタンスが高可用性構成になっているかどうかを示します。

### 7. その他のリソース詳細

S3バケット、ElastiCacheクラスター、ロードバランサーなどのその他のリソースの詳細情報も表示されます：

```markdown
## S3バケット詳細

| バケット名 | リージョン | 作成日時 | サイズ |
| --- | --- | --- | ---: |
| my-app-logs | ap-northeast-1 | 2024-01-15 | 543.21 GB |
| ... | ... | ... | ... |

## ElastiCacheクラスター詳細

| クラスターID | エンジン | ノードタイプ | ノード数 | 状態 | リージョン | 作成日時 |
| --- | --- | --- | ---: | --- | --- | --- |
| redis-cluster-1 | Redis 6.2.5 | cache.m5.large | 3 | available | ap-northeast-1 | 2024-10-25 |
| ... | ... | ... | ... | ... | ... | ... |

## ロードバランサー詳細

| 名前 | タイプ | DNSName | スキーム | リージョン | 作成日時 |
| --- | --- | --- | --- | --- | --- |
| app-alb | Application | app-alb-123456789.ap-northeast-1.elb.amazonaws.com | internet-facing | ap-northeast-1 | 2024-10-15 |
| ... | ... | ... | ... | ... | ... |
```

各リソースタイプは別々のテーブルで表示され、それぞれに関連する詳細情報が含まれます。

### 8. 日次コストトレンド

日次のコスト推移が表形式で表示されます：

```markdown
## 日次コストトレンド

| 日付 | コスト |
| --- | ---: |
| 2025-02-20 | 165.43 USD |
| 2025-02-21 | 172.56 USD |
| ... | ... |
| 2025-03-20 | 182.23 USD |
```

この表を見ることで、日々のコスト変動を分析できます。

### 9. コスト最適化の推奨事項

最後のセクションでは、コスト削減のための具体的な推奨事項が提示されます：

```markdown
## コスト最適化の推奨事項

- **停止中のEC2インスタンス**: 1個のインスタンスが停止状態です。不要であれば削除を検討してください: i-067890a1b2c3d4e5f (backup-server)

- **シングルAZ RDSインスタンス**: 2個のRDSインスタンスがシングルAZ構成です。本番環境では可用性向上のためにマルチAZ構成を検討してください: db-replica-01, db-staging

- **リザーブドインスタンスの活用**: 安定した使用が見込まれるインスタンスに対しては、リザーブドインスタンスの購入を検討してください（最大75%のコスト削減）。

- **自動スケーリングの設定**: 使用パターンに基づいてリソースを自動的にスケールする設定を行うことで、必要なときだけリソースを確保できます。

- **S3のストレージクラスの最適化**: アクセス頻度の低いデータは、Standard-IA, One Zone-IA, Glacierなどの低コストストレージに移行することでコスト削減が可能です。

- **未使用EBSボリュームの削除**: アタッチされていないEBSボリュームを定期的に確認し、不要なものは削除してください。
```

このセクションでは、収集したデータに基づいて自動的に検出された問題（停止中のEC2インスタンス、シングルAZ RDSインスタンスなど）と、一般的なベストプラクティスに基づくアドバイスが提供されます。

## レポートのカスタマイズ

レポートの内容は `config.yml` ファイルを編集することでカスタマイズできます。セクションの有効/無効の切り替えや、分析対象のリソースタイプの変更が可能です。詳細は [カスタマイズガイド](customization.md) を参照してください。

## レポートの補足資料

すべてのレポートは `reports/index.md` ファイルから参照できます。このインデックスファイルは新しいレポートが生成されるたびに自動的に更新され、時系列順にすべてのレポートへのリンクが表示されます：

```markdown
# AWS リソース・コスト レポート一覧

このページには生成されたAWSリソース・コストレポートの一覧が表示されます。

| 日付 | レポート |
| ---- | ------ |
| 2025-03-22 09:15:30 | [aws_resource_cost_report_20250322_091530.md](./aws_resource_cost_report_20250322_091530.md) |
| 2025-03-15 09:15:12 | [aws_resource_cost_report_20250315_091512.md](./aws_resource_cost_report_20250315_091512.md) |
| ... | ... |
```

これにより、過去のレポートとの比較や長期的なコスト傾向の分析が容易になります。
