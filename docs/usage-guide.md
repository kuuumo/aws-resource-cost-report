# 使用方法ガイド

このガイドでは、AWS リソース・コスト レポートツールの基本的な使用方法について説明します。

## 基本的な使用方法

### コマンドライン引数

メインスクリプトは以下のコマンドライン引数をサポートしています：

```
python src/main.py [オプション]
```

### 利用可能なオプション

| オプション | 説明 | デフォルト値 |
|------------|------|------------|
| `--start-date` | コスト分析の開始日（YYYY-MM-DD形式） | 30日前 |
| `--end-date` | コスト分析の終了日（YYYY-MM-DD形式） | 今日 |
| `--regions` | 分析対象のAWSリージョン（カンマ区切り） | all |
| `--output-dir` | レポート出力ディレクトリ | reports |

### 使用例

#### 直近30日間のレポート生成（デフォルト）
```bash
python src/main.py
```

#### 特定期間のレポート生成
```bash
python src/main.py --start-date 2025-01-01 --end-date 2025-01-31
```

#### 特定のリージョンに絞ったレポート生成
```bash
python src/main.py --regions ap-northeast-1,us-east-1
```

#### 出力先ディレクトリの指定
```bash
python src/main.py --output-dir my-reports
```

#### すべてのオプションを組み合わせる
```bash
python src/main.py --start-date 2025-01-01 --end-date 2025-01-31 --regions ap-northeast-1,us-east-1 --output-dir my-reports
```

## GitHub Actionsでの実行

### 自動スケジュール実行

デフォルトでは、GitHub Actionsによって毎週月曜日の午前9時（UTC）にレポートが自動生成されます。この設定は `.github/workflows/generate-report.yml` ファイルの `schedule` セクションで変更できます。

```yaml
on:
  schedule:
    # 毎週月曜日の午前9時(UTC)に実行
    - cron: '0 9 * * 1'
```

クーロン式の書式：
- `0` - 分（0-59）
- `9` - 時間（0-23）
- `*` - 日（1-31）
- `*` - 月（1-12）
- `1` - 曜日（0-6、0が日曜）

### 手動実行

GitHub Actions ワークフローは手動でも実行できます：

1. リポジトリのページで「Actions」タブを選択
2. 左側のサイドバーから「AWS Resource Cost Report」ワークフローを選択
3. 「Run workflow」ボタンをクリック
4. 必要に応じてパラメータを入力（開始日、終了日、リージョン）
5. 「Run workflow」ボタンを再度クリックして実行

### GitHub Actionsの実行結果の確認

GitHub Actionsが実行されると、以下が行われます：

1. レポートが生成される
2. 生成されたレポートが `reports/` ディレクトリに保存される
3. 変更がリポジトリにコミットされる
4. `reports/index.md` ファイルが更新され、最新のレポートへのリンクが追加される

実行結果は「Actions」タブで確認できます。成功すると、リポジトリに新しいコミットが作成され、最新のレポートが `reports/` ディレクトリに追加されます。

## レポートの構成

生成されるレポートは以下のセクションで構成されています：

1. **概要** - 総コスト、前月比較、最大コストサービスの情報
2. **サービス別コスト** - 各AWSサービスのコスト内訳と全体比
3. **リージョン別コスト** - 各AWSリージョンのコスト内訳と全体比
4. **EC2インスタンス詳細** - EC2インスタンスの詳細情報とコスト
5. **RDSインスタンス詳細** - RDSインスタンスの詳細情報とコスト
6. **その他のリソース詳細** - S3バケット、ElastiCacheクラスター、ロードバランサーなどの情報
7. **日次コストトレンド** - 日々のコスト推移
8. **コスト最適化の推奨事項** - コスト削減のためのヒントと提案

レポートの例は [サンプルレポート](../reports/example_report.md) で確認できます。

## 高度な使用方法

### レポート内容のカスタマイズ

`config.yml` ファイルを編集することで、レポートに含める内容をカスタマイズできます。詳細は [カスタマイズガイド](customization.md) を参照してください。

### 新しいリソースタイプの追加

新しいAWSリソースタイプの情報を収集するには、`src/collectors/` ディレクトリに新しいコレクタークラスを追加し、`src/main.py` ファイルを更新する必要があります。詳細は [カスタマイズガイド](customization.md) を参照してください。

### トラブルシューティング

問題が発生した場合は、[トラブルシューティングガイド](troubleshooting.md) を参照してください。
